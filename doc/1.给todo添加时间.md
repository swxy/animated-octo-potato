# 计划
按照Redux源码中示例的TodoMVC，总算没有差错的跑了起来。结果和预期的一模一样。
页面效果一致，学到的东西也毫无长进，唯一的区别可能就是多熟悉了几个API。

在todo的基础之上，暂时先给todo添加一个时间，标识什么时候可以完成，字段可以任意编辑。

# 实现
之前有听说过ant.design不错，正好借此机会试试水。

首先需要改写添加todo的方式，由之前的直接页面输入，更改为再dialog中添加todo的方式。
然后在dialog中引入ant.design的时间选择器。

由于考虑到添加todo之后，还需要对其编辑，新增和编辑的唯一区别就是有没有初始数据，
其次就是保存时需要分别处理一下。为了省事，决定让新增和编辑共用一个组件实例。

由于共用一个组件，dialog放到最顶层即`App.js`加载比较方便，然后在`actions/index.js`
给其增加一个事件处理函数

```
export const toggleTodoDialog = (isOpen, todo) => ({type: types.TOGGLE_TODO_DIALOG, isOpen, todo});
```

其对应的reducer为 `reducers/todoDialog.js`:

```
import { TOGGLE_TODO_DIALOG } from '../constants/ActionTypes';

const initialState = {
    visible: false,
    todo: {}
};

export default function TodoDialog (state = initialState, action) {
    switch (action.type) {
        case TOGGLE_TODO_DIALOG:
            let nextState = {todo: {}, visible: !state.visible};
            if (action.todo) {
                nextState.todo = action.todo;
            }
            if (typeof action.isOpen === 'boolean') {
                nextState.visible = action.isOpen;
            }
            return nextState;

        default:
            return state
    }
}
```

通过全局中的`visible`属性来标识dialog是展示还是隐藏，同时如果编辑的话这设置其相关的内容。

为了实现dialog中的内容可变，还需要监听一下`componentWillReceiveProps`：

```
componentWillReceiveProps(nextProps) {
        const todo = nextProps.todo;
        if (todo.text) {
            this.setState({
                text: todo.text,
                date: todo.date ? moment(todo.date) : null
            });
        }
    }
```

然后在每次关闭dialog时都清空一下state中的数据, 以保证新增todo时不会出现其他todo的数据

```
clearState () {
   this.setState({text: '', date: null});
}
```