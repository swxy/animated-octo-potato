虽然支持离线存储，但存储是基于浏览器级别，如果被清空或者换一个浏览器，数据就没有了。
由于提供一个服务器又有点麻烦，因而先做个导入导出暂时解决这个问题。

## 导出
使用`indexDB`存储数据时，其格式就是`json`，所以导出一个json文本最为方便。于是先支持导出为json文件

```
handleDownload () {
    let todos = this.props.todos.map((todo) => {
        const {text, date, tags, completed} = todo;
        return {text, date, tags, completed};
    });
    const str = JSON.stringify(todos, null, 4);
    const uri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(str);
    this.setState({downloadUri: uri});
}
```

然后直接使用超链接下载文件：

```
<a href={this.state.downloadUri} download="todos.json">
    <Button type="dashed" onClick={this.handleDownload.bind(this)}>export json</Button>
</a>
```

## 导入
导入时涉及到文件上传，由于数据存储到浏览器，所以只需要简单获取文件内容就行，于是使用原生input实现上传功能

```
<label htmlFor="uploadTodos" className="ant-btn ant-btn-ghost" style={{marginLeft: '20px'}}>
    <input type="file" id="uploadTodos" accept=".json"
           style={{display: "none"}}
           ref={(ref) => {
               this.fileUpload = ref;
           }}
           onChange={this.handleUpload.bind(this)}/>
    upload json
</label>
```

为了改变输入按钮样式，将input隐藏，然后定义相对应的label的样式，然后需要使用`ref`来获取input元素，以便获取
文本内容。然后监听input的`onChange`事件，当选择文件时，会触发该事件。

```
handleUpload () {
    const reader = new FileReader();
    const that = this;
    reader.onload = (evt) => {
        let obj = JSON.parse(evt.target.result);
        that.props.bulkAddTodos(obj);
        console.dir(obj);
    };
    reader.readAsText(this.fileUpload.files[0]);
}
```

对应的action操作为：

```
export const bulkAddTodos = (todos) => (dispatch, getState) => {
    bulkAddTodosToDb(todos).then(res => {
        queryTodos(dispatch, getState());
    })
};
```

对应的数据库操作为：

```
export const bulkAddTodosToDb = (todos) => {
    if (Array.isArray(todos)) {
        const id = +new Date();
        todos.map((todo, idx) => {
            todo._id = id + idx + '';
        });
        return db.bulkDocs(todos).then(res => {
            console.log('bulk add todos success');
            return res;
        });
    }
    else {
        throw new Error('todos must be array');
    }
};
```

这里使用`pouchDB`提供的`bulkDocs`api来实现对数据的批量操作，据说速度还是很快的哦，因为使用的是
同一个事务。